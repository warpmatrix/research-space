# 龙蜥云原生专场

CentOS -> Anolis

## 龙蜥云原生社区发展 & kata 社区共建

云原生系统架构：管控系统、云原生节点系统

- 云原生管控系统：应用定义、服务框架、业务编排

云原生操作系统：

- K8S 发行版出发 vs 龙蜥云原生操作系统出发
  - 云原生 OS、利用容器化思想演进 OS （软件发布）
- 节点管控、安全、运维
- 云原生 runtime、存储、网络
- 容器优化 OS、分发部署

龙蜥云原生 SIG 定位：桥梁、组件、系统

- kata container：go -> rust、**机密容器**、安全沙箱、CGroup v2、GPU

## 基于龙蜥与 koordinator 在离线混部实践

常见的负载类型：

- 业务应用：（有/无）状态应用
- 离线任务：实时性、非实时性

混部探索：计算存储混部、Mesos & docker、K8s + Kata、龙蜥 + koorinator

影响通用混部的关键因素：额外资源、服务质量、任务适配

koordinator：在 k8s 上进一步增强插件

- 二次分配额外资源、资源多次分配
- 任务适配：对不同的 latency 要求的应用等进行分配
  - 在线任务调度器、离线任务的调度器

试点应用：内容生产、视频再编码、离线计算

## 基于 ContainerOS 应用的实践经验

云计算发展阶段：单机服务器 -> 云化 -> 云原生化

- 资源自动化：设备为中心 -> 资源为中心
- 应用自动化：资源为中心 -> 应用为中心

containerOS vs trad. OS：

- k8s 统一运维管理物理设备、轻量级 OS 整体升级
- 基于 sealer 一键部署

可以将 trad. OS 迁移到 container OS 中

## 机密容器的崛起与发展

机密容器：运行在保险箱里面的容器

- 数据合规、数据隐私保护、算法和模型保护
- 机密计算的安全性、可自证性、传统容器的易用性、信任依赖问题

基于 TEE 保证运行态数据的机密性、完整性、安全性保护

- 不同级别的安全保证方式：pod 级、进程级
- RunD 的安全沙箱

BigDL 隐私保护机器学习（Privacy Preserving ML, Big DL PPML）：[github](https://github.com/intel-analytics/BigDL)

- 基于 TDX 机密容器，构建 PPML 机密学习模型

## Cloud Hypervisor

为什么轻量化虚拟机管理器（VMM）对于运行现代云业务负载以最少硬件仿真很重要——从 Cloud Hypervisor 开源项目说起

Cloud Hypervisor 的源起

- Hypervisor: KVM、MSHV 暴露硬件可视化特征给 VMM
- VMM：QEMU 虚拟机可视化，提供用户接口
- Rust VMM：轻量级

Intel Cloud Hypervisor：基于 Rust VMM 项目的实现

- 裁剪、模块化（按需加载）
- Host Hardware -> Linux Kernel (Hyper-V)
  - device manager 热插拔

## 中移动算力网络中的云原生虚拟化

算力网络：2020-2022

- 新基建、三年工作计划
- 算力泛在：空间、逻辑（云边端）、内核
- 相关工作：云 IDE、虚拟化安全隔离
  - pod 级的出入双向白名单、云原生虚拟化内核级防止逸散

## Java 云原生能力重磅升级：高性能和可观测的新时代

JVM 持续系统分析（Continuous Profiling）

- thread profiles、system profile、jvm profiles
- stack trace -> frame graph

JFR 与 Async-Profile 实现系统的可观测

- continues profiling 的问题：长时间的聚合问题 $O(n)$
- 预聚合：一边读取一边聚合 $O(\log n)$

java vector api：向量化运算

- 版本需求：openjdk16+、业务代码修改
- dragonwell：将 vector api 移植 java8

## 如何在云原生时代下管理微服务应用

k8s 中的微服务相关痛点：

- 多套环境的搭建问题
  - 分支管理、环境复制，涉及大量的脚本编写问题
- 微服务编排问题：没有办法快速得到依赖关系、微服务爆炸导致编排文件过于复杂
  - 模块复用仍然需要大量修改配置文件
- 任务交付问题：需要手动查看是否成功完成任务启动

rainbound 中的微服务：

- 应用级别抽象
  - 引入框架插件：根据需要选择框架
  - 组件级别插件：按需启动组件
- 组件复用：应用市场供第三方使用者复用

## Serverless Computing 的技术架构

serverless 的系统架构：

- 系统层：系统协调层、系统调度层
  - 后台软件支持，保证细粒度函数的正确运行
  - 单个函数的资源扩展
- 容器封装层：初始化容器、预热特定函数的容器
  - 预热池：初始化容器的执行环境

具体的分层架构：

- 虚拟化层：创建函数运行的容器 (runc, rund)
  - 基于虚拟机VM：隔离性好，但开销过大
  - 类 runc 容器：开销较小、安全性较差
  - 基于安全容器：容器隔离性更强
  - 基于 unikernel：编译后无法修改、兼容性较差
- 容器封装层：容器预热技术
  - 独立容器预热池：为每一个容器构建独立的预热池，系统开销较大
  - 模板容器池：为所有的函数预热同一套的容器，从模板池中取出进行特异化，资源占用较小、但特异化开销较大（甚至比冷启动更大）
- 系统层：协调编排工作
  - 复杂拓扑逻辑工作的支持（DAG 图引擎）
  - 集群资源管理器、负载均衡器

未来展望：

- 通用化：存储系统、不止计算架构
- 高效化：异构硬件统一抽象、应用模板和应用画像的结合
- 智能化：serverless 混部下的 SLA 保障，指导容器规格

## 基于 kata 的 Serverless 产品体系建设

kata 安全容器

数字化转型的相关政策：

- 23年年底国资监管重点应用系统上云率 100%
- 25年国资夹企云使用比例不少于 50%
